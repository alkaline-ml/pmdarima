
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/model_selection/example_cross_validation.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_model_selection_example_cross_validation.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_model_selection_example_cross_validation.py:


========================================
Cross-validating your time series models
========================================


Like scikit-learn, ``pmdarima`` provides several different strategies for
cross-validating your time series models. The interface was designed to behave
as similarly as possible to that of scikit to make its usage as simple as
possible.

.. raw:: html

   <br/>

.. GENERATED FROM PYTHON SOURCE LINES 16-60




.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    pmdarima version: 0.0.0
    [CV] fold=0 ..........................................................
    [CV] fold=1 ..........................................................
    [CV] fold=2 ..........................................................
    [CV] fold=0 ..........................................................
    [CV] fold=1 ..........................................................
    [CV] fold=2 ..........................................................
    Model 1 CV scores: [23.928976769042762, 22.289666136443607, 3.7484091943203715]
    Model 2 CV scores: [1.4601922927777993, 15.413429034781762, 5.572225775629682]
    Lowest average SMAPE: 7.481949034396415 (model2)
    Best model:  ARIMA(1,1,2)(0,1,1)[12] intercept






|

.. code-block:: Python

    print(__doc__)

    # Author: Taylor Smith <taylor.smith@alkaline-ml.com>

    import numpy as np
    import pmdarima as pm
    from pmdarima import model_selection

    print("pmdarima version: %s" % pm.__version__)

    # Load the data and split it into separate pieces
    data = pm.datasets.load_wineind()
    train, test = model_selection.train_test_split(data, train_size=165)

    # Even though we have a dedicated train/test split, we can (and should) still
    # use cross-validation on our training set to get a good estimate of the model
    # performance. We can choose which model is better based on how it performs
    # over various folds.
    model1 = pm.ARIMA(order=(2, 1, 1))
    model2 = pm.ARIMA(order=(1, 1, 2),
                      seasonal_order=(0, 1, 1, 12),
                      suppress_warnings=True)
    cv = model_selection.SlidingWindowForecastCV(window_size=100, step=24, h=1)

    model1_cv_scores = model_selection.cross_val_score(
        model1, train, scoring='smape', cv=cv, verbose=2)

    model2_cv_scores = model_selection.cross_val_score(
        model2, train, scoring='smape', cv=cv, verbose=2)

    print("Model 1 CV scores: {}".format(model1_cv_scores.tolist()))
    print("Model 2 CV scores: {}".format(model2_cv_scores.tolist()))

    # Pick based on which has a lower mean error rate
    m1_average_error = np.average(model1_cv_scores)
    m2_average_error = np.average(model2_cv_scores)
    errors = [m1_average_error, m2_average_error]
    models = [model1, model2]

    # print out the answer
    better_index = np.argmin(errors)  # type: int
    print("Lowest average SMAPE: {} (model{})".format(
        errors[better_index], better_index + 1))
    print("Best model: {}".format(models[better_index]))


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 16.596 seconds)


.. _sphx_glr_download_auto_examples_model_selection_example_cross_validation.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: example_cross_validation.ipynb <example_cross_validation.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: example_cross_validation.py <example_cross_validation.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: example_cross_validation.zip <example_cross_validation.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
