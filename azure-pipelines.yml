trigger:
  # Trigger for pushes on every branch
  branches:
    include:
    - '*'

  # Trigger for all tags
  tags:
    include:
    - '*'

pr:
  # Cancel if new commits are pushed to the same PR
  autoCancel: true

  # Trigger for PRs on all branches
  branches:
    include:
    - '*'

variables:
  # Read deployment variables from our secret group
  - group: deploy-vars

jobs:
- template: build_tools/azure/main.yml
  parameters:
    name: 'Windows x86 Python35'
    vmImage: 'vs2017-win2016'

- template: build_tools/azure/main.yml
  parameters:
    name: 'Windows x64 Python35'
    vmImage: 'vs2017-win2016'

- template: build_tools/azure/main.yml
  parameters:
    name: 'Windows x86 Python36'
    vmImage: 'vs2017-win2016'

- template: build_tools/azure/main.yml
  parameters:
    name: 'Windows x64 Python36'
    vmImage: 'vs2017-win2016'

- template: build_tools/azure/main.yml
  parameters:
    name: 'Windows x86 Python37'
    vmImage: 'vs2017-win2016'

- template: build_tools/azure/main.yml
  parameters:
    name: 'Windows x64 Python37'
    vmImage: 'vs2017-win2016'

- template: build_tools/azure/main.yml
  parameters:
    name: 'macOS Python35'
    vmImage: 'macOS-latest'

- template: build_tools/azure/main.yml
  parameters:
    name: 'macOS Python36'
    vmImage: 'macOS-latest'

- template: build_tools/azure/main.yml
  parameters:
    name: 'macOS Python37'
    vmImage: 'macOS-latest'
