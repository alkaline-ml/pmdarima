name: Build PyPy Dependencies

on: [push]  # Just do it on push for now

jobs:
  build:
    name: Build PyPy Dependencies
    runs-on: ubuntu-latest
    container: pypy:3.6-7.1.1
    steps:
      - name: Checkout code
        uses: actions/checkout@master

      - name: Fix Python Version
        run: ln -sf `which pypy3` /usr/bin/python

      - name: Build requirements
        run: |
          python -m pip install --upgrade pip
          python -m pip install --target=${GITHUB_WORKSPACE}/packages "$(cat requirements.txt | grep Cython)"
          python -m pip install --target=${GITHUB_WORKSPACE}/packages "$(cat requirements.txt | grep numpy)"

      - name: Checking requirements
        run: ls packages
